"use strict";(self.webpackChunkangular_anb=self.webpackChunkangular_anb||[]).push([[6926],{80355:(xt,rt,C)=>{C.d(rt,{KC:()=>z,QI:()=>ot,wF:()=>g,K:()=>w,Yx:()=>X,nb:()=>x,BH:()=>at,NL:()=>N,Tg:()=>J});var H=C(2076),mt=C(62208),V=C(60295),q=C(77692);const F=new Map;F.set("meter-per-second",1),F.set("kilometer-per-hour",.277778),F.set("knots",.514444),F.set("feet-per-second",.3048),F.set("mile-per-hour",.44704);const G=180/Math.PI,N=new H.Xn({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function X(t,r){return F.get(t)/F.get(r)||1}function tt(t){return(450-t)%360}function J(t,r="geographic"){const[n,e]=t,a=Math.sqrt(n*n+e*e);let o=Math.atan2(e,n)*G;return o=(360+o)%360,"geographic"===r&&(o=tt(o)),[a,o]}function et(t,r="geographic"){let n=t[1];"geographic"===r&&(n=tt(n)),n%=360;const e=t[0];return[e*Math.cos(n/G),e*Math.sin(n/G)]}function z(t,r,n="geographic",e=1){if(!(0,q.nk)(t))return t;const{pixels:a,width:o,height:c}=t,f=o*c,M=a[0],s=a[1],h=V.Z.createEmptyBand(t.pixelType,f),i=V.Z.createEmptyBand(t.pixelType,f);let l=0;for(let p=0;p<c;p++)for(let y=0;y<o;y++)"vector-uv"===r?([h[l],i[l]]=J([M[l],s[l]],n),h[l]*=e):([h[l],i[l]]=et([M[l],s[l]],n),h[l]*=e,i[l]*=e),l++;const d=new V.Z({pixelType:t.pixelType,width:t.width,height:t.height,mask:t.mask,validPixelCount:t.validPixelCount,maskIsAlpha:t.maskIsAlpha,pixels:[h,i]});return d.updateStatistics(),d}function ot(t,r,n=1){if(1===n||!(0,q.nk)(t))return t;const e=t.clone(),{pixels:a,width:o,height:c}=e,f=a[0],M=a[1];let s=0;for(let h=0;h<c;h++)for(let i=0;i<o;i++)"vector-uv"===r?(f[s]*=n,M[s]*=n):f[s]*=n,s++;return e.updateStatistics(),e}function at(t,r,n,e,a){if(!(0,mt.pC)(a)||!a.spatialReference.equals(t.spatialReference))return{extent:t,width:r,height:n,resolution:t.width/r};const o=a.xmin,c=a.ymax;e=Math.max(e||0,30);const f=Math.ceil(r*(1/e)),M=Math.ceil(n*(1/e)),s=((t.xmax-t.xmin)/f+(t.ymax-t.ymin)/M)/2;return t.xmin=o+Math.floor((t.xmin-o)/s)*s,t.xmax=o+Math.ceil((t.xmax-o)/s)*s,t.ymin=c+Math.floor((t.ymin-c)/s)*s,t.ymax=c+Math.ceil((t.ymax-c)/s)*s,{extent:t,width:Math.round(t.width/s),height:Math.round(t.height/s),resolution:s}}const Q=function st(t=0,r=0,n=Math.PI,e=!0){e&&(n=(2*Math.PI-n)%(2*Math.PI));const a=e?-1:1,o=13*a,c=-7*a,f=-2*a,M=-16*a,s=29,[h,i]=L(0,r+o,n,s),[l,d]=L(t-5.5,r+c,n,s),[p,y]=L(t+5.5,r+c,n,s),[I,b]=L(t-1.5,r+f,n,s),[O,P]=L(t+1.5,r+f,n,s),[U,D]=L(t-1.5,r+M,n,s),[E,k]=L(t+1.5,r+M,n,s);return[h,i,l,d,I,b,O,P,p,y,U,D,E,k]}(0,0,0);function it(t=0,r=Math.PI,n=!0){n&&(r=(2*Math.PI-r)%(2*Math.PI));const a=n?-1:1,o=5*a,c=20*a,f=25*a,M=45,d=2*a;let[p,y]=[5,0-c],[I,b]=[p+2,y],[O,P]=[I-0,b+d],[U,D]=[-5,0-f],[E,k]=[U+0,D-d],T=Math.ceil(t/5),A=Math.floor(T/10);T-=8*A;const v=[],B=[];for(let ut=0;ut<T/2;ut++,A--){A<=0&&T%2==1&&ut===(T-1)/2&&(U=0,E=U+0,D=(D+y)/2,k=D-d);const[gt,Mt]=L(U,D,r,M);if(A>0){const[ft,dt]=L(I,D,r,M),[pt,_t]=L(p,y,r,M);v.push(ft),v.push(dt),v.push(gt),v.push(Mt),v.push(pt),v.push(_t)}else{const[ft,dt]=L(I,b,r,M),[pt,_t]=L(O,P,r,M),[Et,At]=L(E,k,r,M);B.push(gt),B.push(Mt),B.push(Et),B.push(At),B.push(pt),B.push(_t),B.push(ft),B.push(dt)}D+=o,y+=o,b+=o,P+=o,k+=o}const[W,j]=L(5,0+c,r,M),[nt,ht]=L(7,0+c,r,M),[ct,wt]=L(5,0-f,r,M),[yt,Pt]=L(7,0-f,r,M);return{pennants:v,barbs:B,shaft:[W,j,nt,ht,ct,wt,yt,Pt]}}function L(t,r,n,e=1){const a=Math.sqrt(t*t+r*r)/e,o=(2*Math.PI+Math.atan2(r,t))%(2*Math.PI);return[a,(2*Math.PI+o-n)%(2*Math.PI)]}const S=[0,1,3,6,10,16,21,27,33,40,47,55,63],lt=[0,.5,1,1.5,2],Y=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function R(t,r,n,e){const a=X(e||"knots",n);let o;for(o=1;o<r.length;o++)if(o===r.length-1){if(t<r[o]*a)break}else if(t<=r[o]*a)break;return Math.min(o-1,r.length-2)}function $(t,r,n,e,a){let o=0;switch(r){case"beaufort_kn":o=R(t,S,"knots",n);break;case"beaufort_km":o=R(t,S,"kilometer-per-hour",n);break;case"beaufort_ft":o=R(t,S,"feet-per-second",n);break;case"beaufort_m":o=R(t,S,"meter-per-second",n);break;case"classified_arrow":o=R(t,a,e,n);break;case"ocean_current_m":o=R(t,lt,"meter-per-second",n);break;case"ocean_current_kn":o=R(t,Y,"knots",n)}return o}const u=[];function w(t,r){let e=0,a=0;const{width:o,height:c,mask:f}=t,M=t.pixels[0],s=[],h=[],i="wind_speed"===r.style?5:Number.MAX_VALUE;for(let l=0;l<c;l++)for(let d=0;d<o;d++){const p=l*o+d;if((!f||f[l*o+d])&&M[p]<i){for(let I=0;I<4;I++)s[e++]=(d+.5)/o,s[e++]=(l+.5)/c,s[e++]=I<2?-.5:.5,s[e++]=I%2==0?-.5:.5,s[e++]=0,s[e++]=M[p];const y=4*(e/24-1);h[a++]=y,h[a++]=y+1,h[a++]=y+2,h[a++]=y+1,h[a++]=y+2,h[a++]=y+3}}return{vertexData:new Float32Array(s),indexData:new Uint32Array(h)}}function g(t,r){return"simple_scalar"===r.style?w(t,r):"wind_speed"===r.style?function m(t,r){if(0===u.length)for(let p=0;p<30;p++)u.push(it(5*p,0));const n=X(N.fromJSON(r.inputUnit),"knots"),{width:e,height:a,mask:o}=t,c=t.pixels[0],f=t.pixels[1],s=[],h=[];let i=0,l=0;for(let p=0;p<a;p++)for(let y=0;y<e;y++){const I=p*e+y,b=c[I]*n;if((!o||o[p*e+y])&&b>=5){var d;const O=null!=(d=(f[I]+360)%360/180*Math.PI)?d:2*Math.PI*Math.random(),{pennants:P,barbs:U,shaft:D}=u[Math.min(Math.floor(b/5),29)];if(P.length+U.length===0)continue;let E=s.length/6;const k=(y+.5)/e,T=(p+.5)/a;for(let A=0;A<P.length;A+=2)s[i++]=k,s[i++]=T,s[i++]=P[A],s[i++]=P[A+1]+O,s[i++]=0,s[i++]=b;for(let A=0;A<U.length;A+=2)s[i++]=k,s[i++]=T,s[i++]=U[A],s[i++]=U[A+1]+O,s[i++]=0,s[i++]=b;for(let A=0;A<D.length;A+=2)s[i++]=k,s[i++]=T,s[i++]=D[A],s[i++]=D[A+1]+O,s[i++]=0,s[i++]=b;for(let A=0;A<P.length/6;A++)h[l++]=E,h[l++]=E+1,h[l++]=E+2,E+=3;for(let A=0;A<U.length/8;A++)h[l++]=E,h[l++]=E+1,h[l++]=E+2,h[l++]=E+1,h[l++]=E+2,h[l++]=E+3,E+=4;h[l++]=E+0,h[l++]=E+1,h[l++]=E+2,h[l++]=E+1,h[l++]=E+3,h[l++]=E+2,E+=4}}return{vertexData:new Float32Array(s),indexData:new Uint32Array(h)}}(t,r):function _(t,r){const{style:n,inputUnit:e,outputUnit:a,breakValues:o}=r,c=N.fromJSON(e),f=N.fromJSON(a);let h=0,i=0;const{width:l,height:d,mask:p}=t,y=t.pixels[0],I=t.pixels[1],b=p?p.filter(D=>D>0).length:l*d,O=new Float32Array(42*b),P=new Uint32Array(15*b);for(let D=0;D<d;D++)for(let E=0;E<l;E++){const k=D*l+E;if(!p||p[D*l+E]){var U;const T=null!=(U=(I[k]+360)%360/180*Math.PI)?U:2*Math.PI*Math.random(),A=$(y[k],n,c,f,o);for(let B=0;B<Q.length;B+=2)O[h++]=(E+.5)/l,O[h++]=(D+.5)/d,O[h++]=Q[B],O[h++]=Q[B+1]+T,O[h++]=A,O[h++]=y[k];const v=7*(h/42-1);P[i++]=v,P[i++]=v+1,P[i++]=v+2,P[i++]=v+0,P[i++]=v+4,P[i++]=v+3,P[i++]=v+0,P[i++]=v+2,P[i++]=v+3,P[i++]=v+2,P[i++]=v+5,P[i++]=v+3,P[i++]=v+5,P[i++]=v+6,P[i++]=v+3}}return{vertexData:O,indexData:P}}(t,r)}function x(t,r,n,e=[0,0],a=.5){const{width:o,height:c,mask:f}=t,[M,s]=t.pixels,[h,i]=e,l=Math.round((o-h)/n),d=Math.round((c-i)/n),p=l*d,y=new Float32Array(p),I=new Float32Array(p),b=new Uint8Array(p),O="vector-uv"===r;for(let U=0;U<d;U++)for(let D=0;D<l;D++){let E=0;const k=U*l+D,T=Math.max(0,U*n+i),A=Math.max(0,D*n+h),v=Math.min(c,T+n),B=Math.min(o,A+n);for(let W=T;W<v;W++)for(let j=A;j<B;j++){const K=W*o+j;if(!f||f[K]){E++;const nt=O?[M[K],s[K]]:[M[K],(360+s[K])%360],[ht,ct]=O?nt:et(nt);y[k]+=ht,I[k]+=ct}}if(E>=(v-T)*(B-A)*(1-a)){b[k]=1;const[W,j]=J([y[k]/E,I[k]/E]);y[k]=W,I[k]=j}else b[k]=0,y[k]=0,I[k]=0}const P=new V.Z({width:l,height:d,pixels:[y,I],mask:b});return P.updateStatistics(),P}},37084:(xt,rt,C)=>{C.d(rt,{z_:()=>et,KK:()=>lt});var H=C(15861),V=(C(29132),C(63290)),q=C(21286),F=C(62208),G=C(10699),Z=C(4619),N=C(37053),X=C(2004);const tt=V.Z.getLogger("esri.views.2d.engine.flow.dataUtils");function et(_,u,m){return z.apply(this,arguments)}function z(){return(z=(0,H.Z)(function*(_,u,m){const w=performance.now(),g=ot(_,u),x=performance.now(),t=Q(_,g,u.width,u.height),r=performance.now(),n=it(t,!0),e=performance.now(),a=L(n),o=performance.now();if(_.profile){const c={"_createFlowFieldFromData()":Math.round(x-w),"_getStreamlines()":Math.round(r-x),"createAnimatedLinesData()":Math.round(e-r),"createLinesMesh()":Math.round(o-e),"Total elapsed time":Math.round(o-w)};tt.info("createStreamlinesMesh profile",c)}return yield Promise.resolve(),(0,G.k_)(m),a})).apply(this,arguments)}function ot(_,u){const m=function st(_,u,m,w){if(0===w)return _;const g=Math.round(3*w),x=new Array(2*g+1);let t=0;for(let e=-g;e<=g;e++){const a=Math.exp(-e*e/(w*w));x[e+g]=a,t+=a}for(let e=-g;e<=g;e++)x[e+g]/=t;const r=new Float32Array(_.length);for(let e=0;e<m;e++)for(let a=0;a<u;a++){let o=0,c=0;for(let f=-g;f<=g;f++){if(a+f<0||a+f>=u)continue;const M=x[f+g];o+=M*_[2*(e*u+(a+f))+0],c+=M*_[2*(e*u+(a+f))+1]}r[2*(e*u+a)+0]=o,r[2*(e*u+a)+1]=c}const n=new Float32Array(_.length);for(let e=0;e<u;e++)for(let a=0;a<m;a++){let o=0,c=0;for(let f=-g;f<=g;f++){if(a+f<0||a+f>=m)continue;const M=x[f+g];o+=M*r[2*((a+f)*u+e)+0],c+=M*r[2*((a+f)*u+e)+1]}n[2*(a*u+e)+0]=o,n[2*(a*u+e)+1]=c}return n}(u.data,u.width,u.height,_.smoothing);return _.interpolate?(w,g)=>{const x=Math.floor(w),t=Math.floor(g);if(x<0||x>=u.width)return[0,0];if(t<0||t>=u.height)return[0,0];const r=w-x,n=g-t,o=x<u.width-1?x+1:x,c=t<u.height-1?t+1:t;return[(m[2*(t*u.width+x)]*(1-n)+m[2*(c*u.width+x)]*n)*(1-r)+(m[2*(t*u.width+o)]*(1-n)+m[2*(c*u.width+o)]*n)*r,(m[2*(t*u.width+x)+1]*(1-n)+m[2*(c*u.width+x)+1]*n)*(1-r)+(m[2*(t*u.width+o)+1]*(1-n)+m[2*(c*u.width+o)+1]*n)*r]}:(w,g)=>{const x=Math.round(w),t=Math.round(g);return x<0||x>=u.width||t<0||t>=u.height?[0,0]:[m[2*(t*u.width+x)+0],m[2*(t*u.width+x)+1]]}}function at(_,u,m,w,g,x,t,r,n){const e=[];let a,o,c=m,f=w,M=0;e.push({x:c,y:f,t:M});for(let s=0;s<_.verticesPerLine;s++){let[h,i]=u(c,f);h*=_.velocityScale,i*=_.velocityScale;const l=Math.sqrt(h*h+i*i);if(l<_.minSpeedThreshold)return e;const d=h/l,p=i/l;if(c+=d*_.segmentLength,f+=p*_.segmentLength,M+=_.segmentLength/l,Math.acos(d*a+p*o)>_.maxTurnAngle)return e;if(_.mergeLines){const y=Math.round(c*n),I=Math.round(f*n);if(y<0||y>t-1||I<0||I>r-1)return e;const b=x[I*t+y];if(-1!==b&&b!==g)return e;x[I*t+y]=g}e.push({x:c,y:f,t:M}),a=d,o=p}return e}function Q(_,u,m,w){const g=[],x=new Z.Z,t=1/Math.max(_.lineCollisionWidth,1),r=Math.round(m*t),n=Math.round(w*t),e=new Int32Array(r*n);for(let o=0;o<e.length;o++)e[o]=-1;const a=[];for(let o=0;o<w;o+=_.lineSpacing)for(let c=0;c<m;c+=_.lineSpacing)a.push({x:c,y:o,sort:x.getFloat()});a.sort((o,c)=>o.sort-c.sort);for(const{x:o,y:c}of a)if(x.getFloat()<_.density){const f=at(_,u,o,c,g.length,e,r,n,t);if(f.length<2)continue;g.push(f)}return g}function it(_,u){const m=new Z.Z,w=_.reduce((n,e)=>n+e.length,0),g=new Float32Array(3*w),x=new Array(_.length);let t=0,r=0;for(const n of _){const e=t;for(const a of n)g[3*t+0]=a.x,g[3*t+1]=a.y,g[3*t+2]=a.t,t++;x[r++]={startVertex:e,numberOfVertices:n.length,totalTime:n[n.length-1].t,timeSeed:u?m.getFloat():0}}return{lineVertices:g,lineDescriptors:x}}function L(_,u=10){const{lineVertices:m,lineDescriptors:w}=_;let g=0,x=0;for(const c of w)g+=2*c.numberOfVertices,x+=6*(c.numberOfVertices-1);const t=new Float32Array(8*g),r=new Uint32Array(x);let n=0,e=0;function o(c,f,M,s,h,i,l){const d=8*n;let p=0;t[d+p++]=c,t[d+p++]=f,t[d+p++]=1,t[d+p++]=M,t[d+p++]=i,t[d+p++]=l,t[d+p++]=s,t[d+p++]=h,n++,t[d+p++]=c,t[d+p++]=f,t[d+p++]=-1,t[d+p++]=M,t[d+p++]=i,t[d+p++]=l,t[d+p++]=-s,t[d+p++]=-h,n++}for(const c of w){const{totalTime:f,timeSeed:M}=c;let s=null,h=null,i=null,l=null,d=null;for(let p=0;p<c.numberOfVertices;p++){const y=m[3*(c.startVertex+p)+0],I=m[3*(c.startVertex+p)+1],b=m[3*(c.startVertex+p)+2];let O=null,P=null,U=null,D=null;if(p>0){O=y-s,P=I-h;const E=Math.sqrt(O*O+P*P);if(O/=E,P/=E,p>1){let k=O+l,T=P+d;const A=Math.sqrt(k*k+T*T);k/=A,T/=A;const v=Math.min(1/(k*O+T*P),u);k*=v,T*=v,U=-T,D=k}else U=-P,D=O;null!==U&&null!==D&&(o(s,h,i,U,D,f,M),r[e++]=n-2,r[e++]=n,r[e++]=n-1,r[e++]=n,r[e++]=n+1,r[e++]=n-1)}s=y,h=I,i=b,l=O,d=P}o(s,h,i,-d,l,f,M)}return{vertexData:t,indexData:r}}function S(_,u){const m=u.pixels,{width:w,height:g}=u,x=new Float32Array(w*g*2);if("vector-uv"===_)for(let t=0;t<w*g;t++)x[2*t+0]=m[0][t],x[2*t+1]=-m[1][t];else if("vector-magdir"===_)for(let t=0;t<w*g;t++){const r=m[0][t],n=(0,q.Vl)(m[1][t]),e=Math.cos(n-Math.PI/2),a=Math.sin(n-Math.PI/2);x[2*t+0]=e*r,x[2*t+1]=a*r}return{data:x,width:w,height:g}}function lt(_,u,m,w,g){return Y.apply(this,arguments)}function Y(){return(Y=(0,H.Z)(function*(_,u,m,w,g){const x=(0,N.C5)(u.spatialReference);if(!x)return R(_,u,m,w,g);const[t,r]=x.valid,e=Math.ceil(u.width/(r-t)),a=u.width/e,o=Math.round(m/e);let c=u.xmin;const f=[];for(let i=0;i<e;i++){const l=new X.Z({xmin:c,xmax:c+a,ymin:u.ymin,ymax:u.ymax,spatialReference:u.spatialReference});f.push(R(_,l,o,w,g)),c+=a}const M=yield Promise.all(f),s={data:new Float32Array(m*w*2),width:m,height:w};let h=0;for(const i of M){for(let l=0;l<i.height;l++)for(let d=0;d<i.width;d++)h+d>=m||(s.data[2*(l*m+h+d)+0]=i.data[2*(l*i.width+d)+0],s.data[2*(l*m+h+d)+1]=i.data[2*(l*i.width+d)+1]);h+=i.width}return s})).apply(this,arguments)}function R(_,u,m,w,g){return $.apply(this,arguments)}function $(){return($=(0,H.Z)(function*(_,u,m,w,g){if("imagery"===_.type){yield _.load({signal:g});const r=_.rasterInfo.dataType,n=yield _.fetchImage(u,m,w,{signal:g});return!n||(0,F.Wi)(n.pixelData)||(0,F.Wi)(n.pixelData.pixelBlock)?{data:new Float32Array(m*w*2),width:m,height:w}:S(r,n.pixelData.pixelBlock)}yield _.load({signal:g});const x=_.rasterInfo.dataType,t=yield _.fetchPixels(u,m,w,{signal:g});return!t||(0,F.Wi)(t.pixelBlock)?{data:new Float32Array(m*w*2),width:m,height:w}:S(x,t.pixelBlock)})).apply(this,arguments)}}}]);