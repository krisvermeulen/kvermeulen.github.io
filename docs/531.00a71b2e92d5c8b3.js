"use strict";(self.webpackChunkangular_anb=self.webpackChunkangular_anb||[]).push([[531],{7848:(ut,W,w)=>{w.d(W,{ym:()=>h,RF:()=>l,vY:()=>H,J9:()=>d,U1:()=>I,Ie:()=>F,G6:()=>z});var D=w(62208),v=w(91179);const V=(e,t,r)=>[t,r],b=(e,t,r)=>[t,r,e[2]],U=(e,t,r)=>[t,r,e[2],e[3]];function H(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,D.pC)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function E({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function _({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function Z(e,t,r){const o=[];let s,g,p,y;for(let S=0;S<r.length;S++){const P=r[S];S>0?(p=E(e,P[0]),y=_(e,P[1]),p===s&&y===g||(o.push(t(P,p-s,y-g)),s=p,g=y)):(s=E(e,P[0]),g=_(e,P[1]),o.push(t(P,s,g)))}return o.length>0?o:null}function T({scale:e,translate:t},r){return r*e[0]+t[0]}function N({scale:e,translate:t},r){return t[1]-r*e[1]}function M(e,t,r){const o=new Array(r.length);if(!r.length)return o;const[s,g]=e.scale;let p=T(e,r[0][0]),y=N(e,r[0][1]);o[0]=t(r[0],p,y);for(let S=1;S<r.length;S++){const P=r[S];p+=P[0]*s,y-=P[1]*g,o[S]=t(P,p,y)}return o}function R(e,t,r){const o=new Array(r.length);for(let s=0;s<r.length;s++)o[s]=M(e,t,r[s]);return o}function l(e,t,r,o,s){return t.x=E(e,r.x),t.y=_(e,r.y),t!==r&&(o&&(t.z=r.z),s&&(t.m=r.m)),t}function h(e,t){return e&&t?(0,v.wp)(t)?l(e,{},t,!1,!1):(0,v.l9)(t)?function m(e,t,r,o,s){const g=function j(e,t,r,o){const s=[],g=r?o?U:b:o?b:V;for(let p=0;p<t.length;p++){const y=Z(e,g,t[p]);y&&y.length>=2&&s.push(y)}return s.length?s:null}(e,r.paths,o,s);return g?(t.paths=g,t):null}(e,{},t,!1,!1):(0,v.oU)(t)?function c(e,t,r,o,s){const g=function Q(e,t,r,o){const s=[],g=r?o?U:b:o?b:V;for(let p=0;p<t.length;p++){const y=Z(e,g,t[p]);y&&y.length>=3&&s.push(y)}return s.length?s:null}(e,r.rings,o,s);return g?(t.rings=g,t):null}(e,{},t,!1,!1):(0,v.aW)(t)?function u(e,t,r,o,s){return t.points=function K(e,t,r,o){return Z(e,r?o?U:b:o?b:V,t)}(e,r.points,o,s),t}(e,{},t,!1,!1):(0,v.YX)(t)?function i(e,t,r,o,s){return t.xmin=E(e,r.xmin),t.ymin=_(e,r.ymin),t.xmax=E(e,r.xmax),t.ymax=_(e,r.ymax),t!==r&&(o&&(t.zmin=r.zmin,t.zmax=r.zmax),s&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}(e,{},t,!1,!1):null:null}function d(e,t,r,o,s){return(0,D.pC)(r)&&(t.points=function O(e,t,r,o){return M(e,r?o?U:b:o?b:V,t)}(e,r.points,o,s)),t}function I(e,t,r,o,s){return(0,D.Wi)(r)||(t.x=T(e,r.x),t.y=N(e,r.y),t!==r&&(o&&(t.z=r.z),s&&(t.m=r.m))),t}function F(e,t,r,o,s){return(0,D.pC)(r)&&(t.rings=function nt(e,t,r,o){return R(e,r?o?U:b:o?b:V,t)}(e,r.rings,o,s)),t}function z(e,t,r,o,s){return(0,D.pC)(r)&&(t.paths=function et(e,t,r,o){return R(e,r?o?U:b:o?b:V,t)}(e,r.paths,o,s)),t}},2466:(ut,W,w)=>{w.r(W),w.d(W,{previewCIMSymbol:()=>$});var j,x,D=w(15861),v=w(23841),A=w(91558),V=w(84792),b=w(10699),U=w(77275),H=w(91179),tt=w(84175),E=w(57052),_=w(32837),Z=w(68937),C=w(80991),K=w(56445),Q=w(37519);(x=j||(j={})).Legend="legend",x.Preview="preview";const T=(x,a,i)=>{if(x&&x.targetSize){let u;if(i){const l=Math.max(i.frame.xmax-i.frame.xmin,i.frame.ymax-i.frame.ymin);u=x.targetSize/(0,v.F2)(l)}else u=x.targetSize/a.referenceSize;return u}return x&&x.scaleFactor?x.scaleFactor:1},N={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:2,ymin:-2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:2,ymin:-2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};function O(x,a,i,u){let l,c;return"function"==typeof x.materialHash?(l=(0,x.materialHash)(a,i,u),c=(0,tt.S)(x.cim,x.materialOverrides)):(l=x.materialHash,c=x.cim),{analyzedCIM:c,hash:l}}var et=w(6172);const nt=new class M{constructor(a,i){this._spatialReference=a,this._avoidSDF=i,this._resourceCache=new Map,this._pictureMarkerCache=new Map,this._textRasterizer=new Z.d,this._cimResourceManager=new E.Z,this._rasterizer=new _.Z(this._cimResourceManager)}rasterizeCIMSymbolAsync(a,i,u,l,c,m,h,f){var d=this;return(0,D.Z)(function*(){l=l||(i?null!=i.centroid?"esriGeometryPolygon":(0,H.Ji)(i.geometry):null)||function X(x){if(!(x&&x.data&&x.data.symbol))return null;switch(x.data.symbol.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}(a);const I=yield d.analyzeCIMSymbol(a,i?function R(x){return(x?Object.keys(x):[]).map(a=>({name:a,alias:a,type:"string"==typeof x[a]?"esriFieldTypeString":"esriFieldTypeDouble"}))}(i.attributes):null,u,l,f);return d.rasterizeCIMSymbol(I,i,l,c,m,h)})()}analyzeCIMSymbol(a,i,u,l,c){var m=this;return(0,D.Z)(function*(){const h=[],f=i?{geometryType:l,spatialReference:m._spatialReference,fields:i}:null;let d;yield(0,tt.c)(a.data,f,m._cimResourceManager,h,m._avoidSDF),(0,b.k_)(c);for(const I of h)"CIMPictureMarker"!==I.cim.type&&"CIMPictureFill"!==I.cim.type&&"CIMPictureStroke"!==I.cim.type||(d||(d=[]),d.push(m.fetchPictureMarkerResource(I,c))),u&&"text"===I.type&&"string"==typeof I.text&&I.text.indexOf("[")>-1&&(I.text=(0,C.Qs)(u,I.text,I.cim.textCase));return d&&(yield Promise.all(d)),h})()}fetchPictureMarkerResource(a,i){var u=this;return(0,D.Z)(function*(){const l=a.materialHash;if(!u._pictureMarkerCache.get(l)){const c=(yield(0,V.default)(a.cim.url,{responseType:"image",signal:i&&i.signal})).data;u._pictureMarkerCache.set(l,c)}})()}rasterizeCIMSymbol(a,i,u,l,c,m){const h=[];for(const f of a){l&&"function"==typeof l.scaleFactor&&(l.scaleFactor=l.scaleFactor(i,c,m));const d=this._getRasterizedResource(f,i,u,l,c,m);if(!d)continue;let I=0,F=d.anchorX||0,z=d.anchorY||0,e=!1,t=0,r=0;if("esriGeometryPoint"===u){const o=T(l,f,null);if(t=(0,C.hf)(f.offsetX,i,c,m)*o||0,r=(0,C.hf)(f.offsetY,i,c,m)*o||0,"marker"===f.type)I=(0,C.hf)(f.rotation,i,c,m)||0,e=!!f.rotateClockwise&&f.rotateClockwise;else if("text"===f.type){if(I=(0,C.hf)(f.angle,i,c,m)||0,void 0!==f.horizontalAlignment)switch(f.horizontalAlignment){case"left":F=-.5;break;case"right":F=.5;break;default:F=0}if(void 0!==f.verticalAlignment)switch(f.verticalAlignment){case"top":z=.5;break;case"bottom":z=-.5;break;case"baseline":z=-.25;break;default:z=0}}}null!=d&&h.push({angle:I,rotateClockWise:e,anchorX:F,anchorY:z,offsetX:t,offsetY:r,rasterizedResource:d})}return this.getSymbolImage(h)}getSymbolImage(a){const i=document.createElement("canvas"),u=i.getContext("2d");let l=0,c=0,m=0,h=0;const f=[];for(let z=0;z<a.length;z++){const e=a[z],t=e.rasterizedResource;if(!t)continue;const r=t.size,o=e.offsetX,s=e.offsetY,g=e.anchorX,p=e.anchorY,y=e.rotateClockWise||!1;let S=e.angle,P=(0,v.F2)(o)-r[0]*(.5+g),k=(0,v.F2)(s)-r[1]*(.5+p),Y=P+r[0],L=k+r[1];if(S){y&&(S=-S);const J=Math.sin(S*Math.PI/180),G=Math.cos(S*Math.PI/180),at=P*G-k*J,it=P*J+k*G,ot=P*G-L*J,st=P*J+L*G,lt=Y*G-L*J,ct=Y*J+L*G,mt=Y*G-k*J,ft=Y*J+k*G;P=Math.min(at,ot,lt,mt),k=Math.min(it,st,ct,ft),Y=Math.max(at,ot,lt,mt),L=Math.max(it,st,ct,ft)}l=P<l?P:l,c=k<c?k:c,m=Y>m?Y:m,h=L>h?L:h;const rt=u.createImageData(t.size[0],t.size[1]);rt.data.set(new Uint8ClampedArray(t.image.buffer)),f.push({offsetX:o,offsetY:s,rotateClockwise:y,angle:S,rasterizedImage:rt,anchorX:g,anchorY:p})}i.width=m-l,i.height=h-c;const d=-l,I=h;for(let z=0;z<f.length;z++){const e=f[z],t=this._imageDataToCanvas(e.rasterizedImage),s=d-e.rasterizedImage.width*(.5+e.anchorX),g=I-e.rasterizedImage.height*(.5-e.anchorY);if(e.angle){const p=(360-e.angle)*Math.PI/180;u.save(),u.translate((0,v.F2)(e.offsetX),-(0,v.F2)(e.offsetY)),u.translate(d,I),u.rotate(p),u.translate(-d,-I),u.drawImage(t,s,g),u.restore()}else u.drawImage(t,s+(0,v.F2)(e.offsetX),g-(0,v.F2)(e.offsetY))}const F=new Q.Z({x:d/i.width-.5,y:I/i.height-.5});return{imageData:0!==i.width&&0!==i.height?u.getImageData(0,0,i.width,i.height):u.createImageData(1,1),anchorPosition:F}}_imageDataToCanvas(a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const i=this._imageDataCanvas,u=i.getContext("2d");return i.width=a.width,i.height=a.height,u.putImageData(a,0,0),i}_imageTo32Array(a,i,u,l){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const c=this._imageDataCanvas,m=c.getContext("2d");if(c.width=i,c.height=u,m.drawImage(a,0,0,i,u),l){m.save();const h=new A.Z(l);m.fillStyle=h.toHex(),m.globalCompositeOperation="multiply",m.fillRect(0,0,i,u),m.globalCompositeOperation="destination-atop",m.drawImage(a,0,0,i,u),m.restore()}return new Uint32Array(m.getImageData(0,0,i,u).data.buffer)}_getRasterizedResource(a,i,u,l,c,m){let h,f,d,I,F=null,z=null;if("esriGeometryPolyline"===u||"esriGeometryPolygon"===u){const t=l&&l.style?l.style:j.Legend,r="esriGeometryPolyline"===u?N.stroke[t]:N.fill[t];if("line"===a.type){if("CIMSolidStroke"!==a.cim.type){if("CIMPictureStroke"===a.cim.type){const o=(0,C.hf)(a.width,i,c,m),s=(0,C.hf)(a.color,i,c,m),{image:g,width:p,height:y}=this._getPictureResource(a,o,s);return this._rasterizePictureResource(a,g,p,y,r,o)}return null}({analyzedCIM:h,hash:d}=O(a,i,c,m)),f=this._embedCIMLayerInVectorMarker(h,r)}else if("marker"===a.type){if("CIMPictureMarker"===a.cim.type||"CIMVectorMarker"!==a.cim.type)return null;a.cim.offsetX=(0,C.hf)(a.offsetX,i,c,m),a.cim.offsetY=(0,C.hf)(a.offsetY,i,c,m),a.cim.rotation=(0,C.hf)(a.rotation,i,c,m),a.cim.markerPlacement=a.markerPlacement,({analyzedCIM:h}=O(a,i,c,m)),d=(0,U.hP)(JSON.stringify(h)).toString(),f=this._embedCIMLayerInVectorMarker(h,r),F=(0,C.hf)(a.size,i,c,m),z=a.path}else{if("text"===a.type)return null;if("fill"===a.type){if("CIMHatchFill"===a.cim.type||"CIMVectorMarker"===a.cim.type||"CIMPictureMarker"===a.cim.type||"CIMPictureFill"===a.cim.type){const o=a.cim.size||a.cim.height;let s,g,p;if("CIMPictureMarker"===a.cim.type||"CIMPictureFill"===a.cim.type)({image:s,width:g,height:p}=this._getPictureResource(a,o,(0,C.hf)(a.color,i,c,m)));else{({analyzedCIM:h,hash:d}=O(a,i,c,m));const y=this._rasterizer.rasterizeJSONResource({cim:h,type:a.type,url:a.url,mosaicHash:d,size:o,path:z},1,this._avoidSDF);s=y.image,g=y.size[0],p=y.size[1]}return this._rasterizePictureResource(a,s,g,p,r,null)}if("CIMSolidFill"!==a.cim.type)return null;({analyzedCIM:h,hash:d}=O(a,i,c,m)),f=this._embedCIMLayerInVectorMarker(h,r)}}}else{if("text"===a.type)return I=this._rasterizeTextResource(a,i,l,c,m),I;({analyzedCIM:h,hash:d}=O(a,i,c,m));const t=T(l,a,null);if("CIMPictureMarker"===a.cim.type){const r=(0,C.hf)(a.size,i,c,m)*t,{image:o,width:s,height:g}=this._getPictureResource(a,r,(0,C.hf)(a.color,i,c,m));return I={image:o,size:[s,g],sdf:!1,simplePattern:!1,anchorX:a.anchorPoint?a.anchorPoint.x:0,anchorY:a.anchorPoint?a.anchorPoint.y:0},I}(0,K.FW)(h,t,{preserveOutlineWidth:!1}),f=h}d+=u,l&&(d+=JSON.stringify(l));const e=this._resourceCache;return e.has(d)?e.get(d):(I=this._rasterizer.rasterizeJSONResource({cim:f,type:a.type,url:a.url,mosaicHash:d,size:F,path:z},window.devicePixelRatio||1,this._avoidSDF),e.set(d,I),I)}_rasterizeTextResource(a,i,u,l,c){const m=T(u,a,null),h=(0,C.hf)(a.text,i,l,c);if(!h||0===h.length)return null;const f=(0,C.hf)(a.fontName,i,l,c),d=(0,C.hf)(a.style,i,l,c),I=(0,C.hf)(a.weight,i,l,c),F=(0,C.hf)(a.decoration,i,l,c),z=(0,C.hf)(a.size,i,l,c)*m,e=(0,C.hf)(a.horizontalAlignment,i,l,c),t=(0,C.hf)(a.verticalAlignment,i,l,c),r=(0,C.nn)((0,C.hf)(a.color,i,l,c)),o=(0,C.nn)((0,C.hf)(a.outlineColor,i,l,c)),s={color:r,size:z,horizontalAlignment:e,verticalAlignment:t,font:{family:f,style:d,weight:I,decoration:F},halo:{size:(0,C.hf)(a.outlineSize,i,l,c)||0,color:o,style:d},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(h,s)}_rasterizePictureResource(a,i,u,l,c,m){const h=document.createElement("canvas"),f=h.getContext("2d");h.height=(0,v.F2)(Math.max(c.frame.ymax-c.frame.ymin,m)),h.width=(0,v.F2)(c.frame.xmax-c.frame.xmin);const d=f.createImageData(u,l);d.data.set(new Uint8ClampedArray(i.buffer));const I=this._imageDataToCanvas(d),F=f.createPattern(I,"repeat"),z=Math.cos((-a.cim.rotation||0)*Math.PI/180),e=Math.sin((-a.cim.rotation||0)*Math.PI/180);F.setTransform({m11:z,m12:e,m21:-e,m22:z,m41:(0,v.F2)(a.cim.offsetX)||0,m42:(0,v.F2)(a.cim.offsetY)||0});const t=c.canvasPaths;let r,o,s;(0,H.oU)(t)?(r=t.rings,f.fillStyle=F,o=f.fill,s=["evenodd"]):(0,H.l9)(t)&&(r=t.paths,f.strokeStyle=F,f.lineWidth=m,o=f.stroke,r[0][0][1]=h.height/2,r[0][1][1]=h.height/2),f.beginPath();for(const y of r){const S=y?y.length:0;if(S>1){let P=y[0];f.moveTo((0,v.F2)(P[0]),(0,v.F2)(P[1]));for(let k=1;k<S;++k)P=y[k],f.lineTo((0,v.F2)(P[0]),(0,v.F2)(P[1]));f.closePath()}}o.apply(f,s);const g=f.getImageData(0,0,h.width,h.height),p=new Uint8Array(g.data);return{size:[h.width,h.height],image:new Uint32Array(p.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}_getPictureResource(a,i,u){const l=this._pictureMarkerCache.get(a.materialHash);if(!l)return null;const c=l.height/l.width,m=i?c>1?(0,v.F2)(i):(0,v.F2)(i)/c:l.width,h=i?c>1?(0,v.F2)(i)*c:(0,v.F2)(i):l.height;return{image:this._imageTo32Array(l,m,h,u),width:m,height:h}}_embedCIMLayerInVectorMarker(a,i){const u=(0,H.oU)(i.geometry)?"CIMPolygonSymbol":"CIMLineSymbol",l=i.frame;return{type:"CIMVectorMarker",frame:l,size:l.ymax-l.ymin,markerGraphics:[{type:"CIMMarkerGraphic",geometry:i.geometry,symbol:{type:u,symbolLayers:[a]}}]}}}(null,!0);function $(x){return q.apply(this,arguments)}function q(){return q=(0,D.Z)(function*(x,a={}){const{size:i,maxSize:u,node:l,opacity:c}=a,m=a.cimOptions||a,{feature:h,fieldMap:f,geometryType:d,style:I}=m,F=(0,K.kW)(x),z=Math.min(null!=i?i:F,null!=u?u:(0,v.Wz)(120));z!==F&&(x=x.clone(),(0,K.PI)(x,z,{preserveOutlineWidth:!0}));let e=3;x&&x.data&&x.data.symbol&&"CIMPointSymbol"!==x.data.symbol.type&&(e=1);const t=yield nt.rasterizeCIMSymbolAsync(x,h,f,d,{scaleFactor:e,style:I}),r=document.createElement("canvas");r.width=t.imageData.width,r.height=t.imageData.height,r.getContext("2d").putImageData(t.imageData,0,0);let o=r.width/e,s=r.height/e;if(null!=i&&(null==(null==a?void 0:a.scale)||(null==a?void 0:a.scale))){const y=o/s;o=y<=1?Math.ceil(z*y):z,s=y<=1?z:Math.ceil(z/y)}const g=new Image(o,s);g.src=r.toDataURL(),null!=c&&(g.style.opacity=`${c}`);let p=g;return null!=a.effectView&&(p=(0,et.w)([[{shape:{type:"image",x:0,y:0,width:o,height:s,src:g.src},fill:null,stroke:null,offset:[0,0]}]],[o,s],{effectView:a.effectView})),l&&l.appendChild(p),p}),q.apply(this,arguments)}},39351:(ut,W,w)=>{w.d(W,{xl:()=>d,aK:()=>I,eF:()=>et,Uh:()=>at,_6:()=>ct,Tz:()=>ot,CQ:()=>it,oK:()=>st,e0:()=>lt,SD:()=>mt,XJ:()=>L,$0:()=>Z,iV:()=>o,Zd:()=>r,Ex:()=>X,uG:()=>t,Jc:()=>p,xm:()=>C,m4:()=>e,MI:()=>G,AI:()=>A,Ip:()=>rt,ru:()=>b,fL:()=>Y,iJ:()=>x,nM:()=>a,Ij:()=>i,f2:()=>u,Ic:()=>q,Al:()=>$,QU:()=>l,Jw:()=>c,kF:()=>m,yP:()=>h,D3:()=>B,Iw:()=>O,tQ:()=>g,I_:()=>U,a:()=>P,CU:()=>S,V4:()=>y});const A=1e-30,b=4294967295,U=512,Z=8,C=29,X=24,O=8,et={metrics:{width:15,height:17,left:0,top:-7,advance:14}},B=0,$=0,q=0,x=1,a=2,i=3,u=4,l=5,c=6,m=5,h=6,d=1,I=2,e=2,t=1,r=2,o=4,g=1.05,p=6,y=5,S=6,P=1.15,Y=2,L=8,rt=500,G=10,at=2,it=0,ot=1,st=4,lt=8,ct=4,mt=1},5254:(ut,W,w)=>{w.d(W,{UJ:()=>Q,Jz:()=>j,Au:()=>C});const D=new Float32Array(1);function C(M){return[255&M,(65280&M)>>>8,(16711680&M)>>>16,(4278190080&M)>>>24]}function Q(M,R){return 65535&M|R<<16}function j(M,R,X,O){return 255&M|(255&R)<<8|(255&X)<<16|O<<24}new Uint32Array(D.buffer)}}]);